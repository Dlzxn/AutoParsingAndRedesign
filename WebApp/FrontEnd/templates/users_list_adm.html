{% extends "base.html" %}

{% block styles %}
  <link rel="stylesheet" href="/WebApp/FrontEnd/styles/users_list_adm.css?v1.10">
{% endblock %}

{% block content %}
<div class="admin-users-container">
  <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h1>

  <div class="controls-header">
    <div class="left-controls">
      <button class="btn-create" onclick="openCreateModal()">+ –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
      <button class="btn-export" onclick="exportCSV()">üìÅ –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
    </div>

    <div class="right-controls">
      <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫...">
      <select id="perPage" onchange="loadUsers()">
        <option value="10">10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É</option>
        <option value="25">25 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É</option>
        <option value="50">50 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É</option>
      </select>
    </div>
  </div>

  <div class="table-container">
    <div class="loader" id="loader">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <table id="usersTable">
      <thead>
        <tr>
          <th data-column="id" onclick="sortTable('id')">ID ‚ñ≤</th>
          <th data-column="email" onclick="sortTable('email')">Email</th>
          <th data-column="subscribe_status" onclick="sortTable('subscribe_status')">–°—Ç–∞—Ç—É—Å</th>
          <th data-column="date_end" onclick="sortTable('date_end')">–ü–æ–¥–ø–∏—Å–∫–∞ –¥–æ</th>
          <th data-column="token_today" onclick="sortTable('token_today')">–¢–æ–∫–µ–Ω—ã</th>
          <th data-column="is_admin" onclick="sortTable('is_admin')">–ê–¥–º–∏–Ω</th>
          <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
      </thead>
      <tbody id="usersBody"></tbody>
    </table>
  </div>

  <div class="pagination">
    <button id="prevPage" onclick="changePage(-1)">‚Üê –ù–∞–∑–∞–¥</button>
    <span id="currentPage">1</span>/<span id="totalPages">1</span>
    <button id="nextPage" onclick="changePage(1)">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeEditModal()">&times;</span>
      <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
      <form id="userForm" onsubmit="saveUser(event)"></form>
    </div>
  </div>

  <div id="createModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeCreateModal()">&times;</span>
    <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
    <form id="createForm" onsubmit="createUser(event)">
      <div class="form-group">
        <label>Email:</label>
        <input type="email" id="createEmail" required>
      </div>

      <div class="form-group">
        <label>–ü–∞—Ä–æ–ª—å:</label>
        <input type="password" id="createPassword" required>
      </div>

      <div class="form-group">
        <label>–°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏:</label>
        <select id="createSubscribeStatus">
          <option value="Free">Free</option>
          <option value="Premium">Premium</option>
          <option value="VIP">VIP</option>
        </select>
      </div>

      <div class="form-group">
        <label>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏:</label>
        <input type="date" id="createDateEnd">
      </div>

      <div class="form-group">
        <label>–õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤:</label>
        <input type="number" id="createTokenToday" min="0" value="0">
      </div>

      <div class="form-group checkbox-group">
        <input type="checkbox" id="createIsAdmin">
        <label>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</label>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-save">–°–æ–∑–¥–∞—Ç—å</button>
        <button type="button" class="btn-cancel" onclick="closeCreateModal()">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </form>
  </div>
</div>

  <div id="confirmModal" class="modal">
    <div class="modal-content">
      <h2>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ</h2>
      <p id="confirmMessage"></p>
      <div class="modal-actions">
        <button class="btn-confirm" onclick="confirmAction()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="btn-cancel" onclick="closeConfirmModal()">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_scripts %}
  <script src="/WebApp/FrontEnd/scr/users_list_adm.js?v1.20"></script>
{% endblock %}